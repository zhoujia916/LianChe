<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="AutoAttrMapper">
    <resultMap id="AutoAttr" type="puzzle.lianche.entity.AutoAttr">
    	<id column="attr_id" property="attrId" /> 
    	<result column="attr_name" property="attrName" /> 
    	<result column="attr_input_type" property="attrInputType" /> 
    	<result column="attr_type" property="attrType" /> 
    	<result column="attr_values" property="attrValues" /> 
    	<result column="sort_order" property="sortOrder" /> 
    </resultMap>

    <sql id="allColumn">
    	attr_id, attr_name, attr_input_type, attr_type, attr_values, sort_order
    </sql>

    <insert id="insert" parameterType="AutoAttr" useGeneratedKeys="true" keyProperty="attrId">
        insert into auto_attr 
        (
        	
        	<if test="attrName != null">attr_name, </if>
        	<if test="attrInputType != null">attr_input_type, </if>
        	<if test="attrType != null">attr_type, </if>
        	<if test="attrValues != null">attr_values, </if>
        	<if test="sortOrder != null">sort_order</if>
        )
        values 
        (
        	
        	<if test="attrName != null">#{attrName}, </if>
        	<if test="attrInputType != null">#{attrInputType}, </if>
        	<if test="attrType != null">#{attrType}, </if>
        	<if test="attrValues != null">#{attrValues}, </if>
        	<if test="sortOrder != null">#{sortOrder}</if>
       	)
    </insert>

    <update id="update" parameterType="AutoAttr">
        update auto_attr
        <set>
        	<if test="attrName != null">  
        		attr_name = #{attrName},
        	</if>
        	<if test="attrInputType != null">  
        		attr_input_type = #{attrInputType},
        	</if>
        	<if test="attrType != null">  
        		attr_type = #{attrType},
        	</if>
        	<if test="attrValues != null">  
        		attr_values = #{attrValues},
        	</if>
        	<if test="sortOrder != null">  
        		sort_order = #{sortOrder}
        	</if>
        </set>
        where attr_id = #{attrId}
    </update>

    <delete id="delete" parameterType="Map">
        delete from auto_attr
        <where>
	        <trim prefixOverrides="and | or">  
	        	<if test="attrId > 0">
	                attr_id = #{attrId}
	            </if>
                <if test="attrIds!=null and attrIds.length>0">
                    attr_id in
                    <foreach collection="attrIds" item="attrId" open="(" separator="," close=")">
                        #{attrId}
                    </foreach>
                </if>
	        	<if test="attrName != null">
	                attr_name = #{attrName}
	            </if>
	        	<if test="attrInputType > 0">
	                attr_input_type = #{attrInputType}
	            </if>
	        	<if test="attrType > 0">
	                attr_type = #{attrType}
	            </if>
	        	<if test="attrValues != null">
	                attr_values = #{attrValues}
	            </if>
	        	<if test="sortOrder > 0">
	                sort_order = #{sortOrder}
	            </if>
	        </trim>
        </where>
    </delete>

    <select id="query" parameterType="Map" resultMap="AutoAttr">
        select <include refid="allColumn"/> from auto_attr
        <where>  
        	<if test="attrId > 0">
                attr_id = #{attrId}
            </if>
        </where> 
    </select>

    <select id="queryList" parameterType="Map" resultMap="AutoAttr">
        select * from auto_attr
        <where>
            <if test="attrName!=null and attrName!=''">
                and attr_name like concat('%',#{attrName},'%')
            </if>
            <if test="typeString!=null and typeString!=''">
                and attr_input_type in (${typeString})
            </if>
        </where>
        order by sort_order desc,attr_id desc
    </select>
</mapper>
